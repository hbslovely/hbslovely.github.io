<div class="cart-container">
  <p-card>
    <ng-template pTemplate="header">
      <div class="cart-header">
        <h2>
          <i class="pi pi-shopping-cart"></i>
          Giỏ hàng
        </h2>
      </div>
    </ng-template>

    @if (cartItems.length > 0) {
      <div class="cart-content">
        <div class="cart-items">
          @for (item of cartItems; track item.id) {
            <div class="cart-item">
              <div class="item-info">
                <h3>{{ item.name }}</h3>
                <p class="price">{{ item.price | currency:'VND':'symbol':'1.0-0' }}</p>
              </div>

              <div class="item-actions">
                <div class="quantity-control">
                  <p-inputNumber
                    [showButtons]="true"
                    [min]="0"
                    [max]="99"
                    [step]="1"
                    [inputStyleClass]="'quantity-input'"
                    [ngModel]="item.quantity"
                    (onInput)="updateQuantity(item.id, $event.value)"
                    buttonLayout="horizontal"
                    spinnerMode="horizontal"
                    decrementButtonClass="p-button-text"
                    incrementButtonClass="p-button-text"
                    incrementButtonIcon="pi pi-plus"
                    decrementButtonIcon="pi pi-minus">
                  </p-inputNumber>
                </div>

                <div class="note-control">
                  <span class="p-float-label">
                    <textarea
                      pInputTextarea
                      [rows]="2"
                      [value]="item.note"
                      (input)="updateNote(item.id, $any($event.target).value)"
                      id="note-{{item.id}}">
                    </textarea>
                    <label for="note-{{item.id}}">Ghi chú</label>
                  </span>
                </div>
              </div>
            </div>
          }
        </div>

        <div class="order-form">
          <h3>Thông tin đặt hàng</h3>

          <div class="form-group">
            <span class="p-float-label">
              <input
                pInputText
                id="customerName"
                [(ngModel)]="orderInfo.customerName"
                required>
              <label for="customerName">Tên của bạn</label>
            </span>
          </div>

          <div class="form-group">
            <span class="p-float-label">
              <input
                pInputText
                id="phone"
                [(ngModel)]="orderInfo.phone"
                required>
              <label for="phone">Số điện thoại</label>
            </span>
          </div>

          <div class="form-group">
            <span class="p-float-label">
              <textarea
                pInputTextarea
                id="address"
                [(ngModel)]="orderInfo.address"
                [rows]="3"
                required>
              </textarea>
              <label for="address">Địa chỉ giao hàng</label>
            </span>
          </div>

          <div class="order-summary">
            <div class="summary-row">
              <span>Tạm tính</span>
              <span>{{ orderInfo.totalAmount | currency:'VND':'symbol':'1.0-0' }}</span>
            </div>
            <div class="summary-row">
              <span>Phí giao hàng</span>
              <span>Miễn phí</span>
            </div>
            <div class="summary-row total">
              <span>Tổng cộng</span>
              <span>{{ orderInfo.totalAmount | currency:'VND':'symbol':'1.0-0' }}</span>
            </div>
          </div>

          <div class="form-actions">
            <p-button
              label="Đặt hàng"
              icon="pi pi-check"
              [disabled]="!orderInfo.customerName || !orderInfo.phone || !orderInfo.address"
              (onClick)="placeOrder()"
              styleClass="p-button-lg">
            </p-button>
          </div>
        </div>
      </div>
    } @else {
      <div class="empty-cart">
        <i class="pi pi-shopping-cart"></i>
        <h3>Giỏ hàng trống</h3>
        <p>Hãy thêm một vài món ngon vào giỏ hàng của bạn</p>
        <p-button
          label="Xem thực đơn"
          icon="pi pi-arrow-left"
          routerLink="/menu">
        </p-button>
      </div>
    }
  </p-card>
</div>
