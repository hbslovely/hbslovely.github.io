<nav class="navbar" [class.scrolled]="isScrolled">
  <div class="container">
    <!-- Logo -->
    <a routerLink="/" class="logo">
      <img src="assets/images/logo.png" alt="HCM City Guide">
      <span>All in One HCM</span>
    </a>

    <!-- Desktop Menu -->
    <div class="nav-menu" [class.active]="isMenuOpen">
      <!-- Main Navigation -->
      <ul class="nav-list">
        <li>
          <a routerLink="/discover" routerLinkActive="active" class="nav-link" (mouseenter)="showSubmenu('discover')">
            <i class="pi pi-compass"></i>
            {{ 'MENU.DISCOVER' | translate }}
          </a>
          <div class="submenu" *ngIf="activeSubmenu === 'discover'" (mouseleave)="hideSubmenu()">
            <div class="submenu-content">
              <div class="submenu-section">
                <h4>{{ 'MENU.DISCOVER_PLACES' | translate }}</h4>
                <ul>
                  <li><a routerLink="/discover/attractions">{{ 'MENU.ATTRACTIONS' | translate }}</a></li>
                  <li><a routerLink="/discover/culture">{{ 'MENU.CULTURE' | translate }}</a></li>
                  <li><a routerLink="/discover/food">{{ 'MENU.FOOD' | translate }}</a></li>
                  <li><a routerLink="/discover/wards">{{ 'MENU.WARDS' | translate }}</a></li>
                </ul>
              </div>
              <div class="submenu-section">
                <h4>{{ 'MENU.TIPS_GUIDES' | translate }}</h4>
                <ul>
                  <li><a routerLink="/discover/tips">{{ 'MENU.TRAVEL_TIPS' | translate }}</a></li>
                  <li><a routerLink="/discover/safety">{{ 'MENU.SAFETY' | translate }}</a></li>
                </ul>
              </div>
            </div>
          </div>
        </li>
        <li>
          <a routerLink="/entertainment" routerLinkActive="active" class="nav-link" (mouseenter)="showSubmenu('entertainment')">
            <i class="pi pi-ticket"></i>
            {{ 'MENU.ENTERTAINMENT' | translate }}
          </a>
          <div class="submenu" *ngIf="activeSubmenu === 'entertainment'" (mouseleave)="hideSubmenu()">
            <div class="submenu-content">
              <div class="submenu-section">
                <h4>{{ 'MENU.VENUES' | translate }}</h4>
                <ul>
                  <li><a routerLink="/entertainment/shopping">{{ 'MENU.SHOPPING' | translate }}</a></li>
                  <li><a routerLink="/entertainment/theme-parks">{{ 'MENU.THEME_PARKS' | translate }}</a></li>
                  <li><a routerLink="/entertainment/nightlife">{{ 'MENU.NIGHTLIFE' | translate }}</a></li>
                </ul>
              </div>
              <div class="submenu-section">
                <h4>{{ 'MENU.ACTIVITIES' | translate }}</h4>
                <ul>
                  <li><a routerLink="/entertainment/cinemas">{{ 'MENU.CINEMAS' | translate }}</a></li>
                  <li><a routerLink="/entertainment/sports">{{ 'MENU.SPORTS' | translate }}</a></li>
                </ul>
              </div>
            </div>
          </div>
        </li>
        <li>
          <a routerLink="/hotels" routerLinkActive="active" class="nav-link" (mouseenter)="showSubmenu('hotels')">
            <i class="pi pi-home"></i>
            {{ 'MENU.HOTELS' | translate }}
          </a>
          <div class="submenu" *ngIf="activeSubmenu === 'hotels'" (mouseleave)="hideSubmenu()">
            <div class="submenu-content">
              <div class="submenu-section">
                <h4>{{ 'MENU.ACCOMMODATION' | translate }}</h4>
                <ul>
                  <li><a routerLink="/hotels/search">{{ 'MENU.SEARCH_HOTELS' | translate }}</a></li>
                  <li><a routerLink="/hotels/hotels">{{ 'MENU.HOTELS_LIST' | translate }}</a></li>
                  <li><a routerLink="/hotels/apartments">{{ 'MENU.APARTMENTS' | translate }}</a></li>
                  <li><a routerLink="/hotels/resorts">{{ 'MENU.RESORTS' | translate }}</a></li>
                </ul>
              </div>
              <div class="submenu-section">
                <h4>{{ 'MENU.WELLNESS' | translate }}</h4>
                <ul>
                  <li><a routerLink="/hotels/spas">{{ 'MENU.SPAS' | translate }}</a></li>
                </ul>
              </div>
            </div>
          </div>
        </li>
        <li>
          <a routerLink="/transport" routerLinkActive="active" class="nav-link" (mouseenter)="showSubmenu('transport')">
            <i class="pi pi-car"></i>
            {{ 'MENU.TRANSPORT' | translate }}
          </a>
          <div class="submenu" *ngIf="activeSubmenu === 'transport'" (mouseleave)="hideSubmenu()">
            <div class="submenu-content">
              <div class="submenu-section">
                <h4>{{ 'MENU.GETTING_AROUND' | translate }}</h4>
                <ul>
                  <li><a routerLink="/transport/search">{{ 'MENU.PLAN_JOURNEY' | translate }}</a></li>
                  <li><a routerLink="/transport/public-transport">{{ 'MENU.PUBLIC_TRANSPORT' | translate }}</a></li>
                  <li><a routerLink="/transport/ride-hailing">{{ 'MENU.RIDE_HAILING' | translate }}</a></li>
                </ul>
              </div>
              <div class="submenu-section">
                <h4>{{ 'MENU.RENTALS' | translate }}</h4>
                <ul>
                  <li><a routerLink="/transport/bike-rental">{{ 'MENU.BIKE_RENTAL' | translate }}</a></li>
                  <li><a routerLink="/transport/car-rental">{{ 'MENU.CAR_RENTAL' | translate }}</a></li>
                </ul>
              </div>
            </div>
          </div>
        </li>
      </ul>

      <!-- Language and Search -->
      <div class="nav-actions">
        <button class="search-button" (click)="openSearch()">
          <i class="pi pi-search"></i>
        </button>
        <button class="language-button" (click)="toggleLanguage()">
          <i class="pi pi-globe"></i>
          <span>{{ currentLanguage | uppercase }}</span>
        </button>
        <button class="donate-button" (click)="onDonate()">
          <i class="pi pi-heart-fill"></i>
          {{ 'MENU.DONATE' | translate }}
        </button>
      </div>
    </div>

    <!-- Mobile Menu Button -->
    <button class="menu-button" (click)="toggleMenu()">
      <span class="menu-icon" [class.active]="isMenuOpen">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>
  </div>
</nav>

<!-- Search Dialog -->
<p-dialog 
  [(visible)]="showSearchDialog"
  [modal]="true"
  [dismissableMask]="true"
  [showHeader]="false"
  [contentStyle]="{padding: '0'}"
  [style]="{width: '90vw', maxWidth: '800px'}"
  (onHide)="closeSearch()">
  <div class="search-dialog">
    <!-- Search Input -->
    <div class="search-header">
      <span class="p-input-icon-left p-input-icon-right">
        <i class="pi pi-search"></i>
        <input 
          #searchInput
          type="text" 
          pInputText 
          [(ngModel)]="searchTerm"
          (ngModelChange)="onSearchInput()"
          (keyup.enter)="onSearch()"
          [placeholder]="'MENU.SEARCH_PLACEHOLDER' | translate">
        <i class="pi pi-times" (click)="closeSearch()" style="cursor: pointer"></i>
      </span>
    </div>

    <!-- Search Content -->
    <div class="search-content">
      <!-- Loading State -->
      <div class="search-loading" *ngIf="isSearching">
        <div class="suggestion-skeleton" *ngFor="let i of [1,2,3]">
          <p-skeleton width="40px" height="40px" styleClass="mr-2"></p-skeleton>
          <div class="skeleton-content">
            <p-skeleton width="200px" height="1rem" styleClass="mb-2"></p-skeleton>
            <p-skeleton width="150px" height="0.875rem"></p-skeleton>
          </div>
        </div>
      </div>

      <!-- Suggestions -->
      <div class="search-suggestions" *ngIf="suggestions.length > 0">
        <div class="suggestion-group">
          <h3>{{ 'SEARCH.SUGGESTIONS' | translate }}</h3>
          <div class="suggestion-list">
            <div 
              *ngFor="let suggestion of suggestions" 
              class="suggestion-item"
              (click)="onSuggestionClick(suggestion)">
              <div class="suggestion-icon">
                <i [class]="getTypeIcon(suggestion.type)"></i>
              </div>
              <div class="suggestion-content">
                <div class="suggestion-title">{{ suggestion.title }}</div>
                <div class="suggestion-subtitle" *ngIf="suggestion.subtitle">{{ suggestion.subtitle }}</div>
              </div>
              <i class="pi pi-arrow-right"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent & Popular Searches -->
      <div class="search-history" *ngIf="!searchTerm && !isSearching">
        <!-- Recent Searches -->
        <div class="history-group" *ngIf="recentSearches.length > 0">
          <div class="group-header">
            <h3>{{ 'SEARCH.RECENT' | translate }}</h3>
            <button 
              pButton 
              type="button" 
              class="p-button-text p-button-sm"
              [label]="'SEARCH.CLEAR' | translate"
              (click)="clearRecentSearches()">
            </button>
          </div>
          <div class="history-list">
            <div 
              *ngFor="let term of recentSearches" 
              class="history-item"
              (click)="onRecentSearchClick(term)">
              <i class="pi pi-clock"></i>
              <span>{{ term }}</span>
            </div>
          </div>
        </div>

        <p-divider *ngIf="recentSearches.length > 0"></p-divider>

        <!-- Popular Searches -->
        <div class="history-group">
          <h3>{{ 'SEARCH.POPULAR' | translate }}</h3>
          <div class="history-list">
            <div 
              *ngFor="let term of popularSearches" 
              class="history-item"
              (click)="onRecentSearchClick(term)">
              <i class="pi pi-star-fill"></i>
              <span>{{ term }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- No Results -->
      <div class="no-results" *ngIf="searchTerm && !isSearching && suggestions.length === 0">
        <i class="pi pi-search"></i>
        <h3>{{ 'SEARCH.NO_RESULTS' | translate }}</h3>
        <p>{{ 'SEARCH.TRY_AGAIN' | translate }}</p>
      </div>
    </div>
  </div>
</p-dialog> 